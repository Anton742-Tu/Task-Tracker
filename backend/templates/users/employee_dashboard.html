{% extends 'base.html' %}

{% block title %}–î–∞—à–±–æ—Ä–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ - Task Tracker{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
    <div class="alert alert-info">
        <h4>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.get_full_name|default:user.username }}!</h4>
        <p class="mb-0">–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫. –í–∞—à email: {{ user.email }}</p>
        <a href="/profile/" class="btn btn-sm btn-outline-info mt-2">üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
    </div>

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="row mt-4">
        <div class="col-md-3">
            <div class="card text-white bg-primary mb-3">
                <div class="card-header">–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
                <div class="card-body">
                    <h4 class="card-title">{{ tasks.count }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-warning mb-3">
                <div class="card-header">–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
                <div class="card-body">
                    <h4 class="card-title">{{ active_tasks.count }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-success mb-3">
                <div class="card-header">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                <div class="card-body">
                    <h4 class="card-title">{{ completed_tasks.count }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-danger mb-3">
                <div class="card-header">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
                <div class="card-body">
                    <h4 class="card-title">{{ overdue_tasks.count }}</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="mb-4">
        <a href="#" class="btn btn-success">‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</a>
        <a href="#" class="btn btn-outline-secondary">üìä –û—Ç—á–µ—Ç—ã</a>
        <a href="/profile/" class="btn btn-outline-primary">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
        <a href="/admin/logout/" class="btn btn-outline-danger float-end">üö™ –í—ã–π—Ç–∏</a>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞—á -->
    <h3>üìã –ú–æ–∏ –∑–∞–¥–∞—á–∏</h3>
    {% if tasks %}
    <table class="table table-hover">
        <thead class="table-light">
            <tr>
                <th>–ó–∞–¥–∞—á–∞</th>
                <th>–ü—Ä–æ–µ–∫—Ç</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                <th>–°—Ä–æ–∫</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr>
                <td>
                    <strong>{{ task.title }}</strong>
                    {% if task.description %}
                    <br><small class="text-muted">{{ task.description|truncatechars:50 }}</small>
                    {% endif %}
                </td>
                <td>{{ task.project.name|default:"–ë–µ–∑ –ø—Ä–æ–µ–∫—Ç–∞" }}</td>
                <td>
                    <span class="badge bg-{% if task.status == 'done' %}success{% elif task.status == 'in_progress' %}warning{% elif task.status == 'review' %}info{% else %}secondary{% endif %}">
                        {{ task.get_status_display }}
                    </span>
                </td>
                <td>
                    {% if task.priority == 'high' %}
                    <span class="badge bg-danger">–í—ã—Å–æ–∫–∏–π</span>
                    {% elif task.priority == 'medium' %}
                    <span class="badge bg-warning">–°—Ä–µ–¥–Ω–∏–π</span>
                    {% else %}
                    <span class="badge bg-secondary">–ù–∏–∑–∫–∏–π</span>
                    {% endif %}
                </td>
                <td>
                    {% if task.due_date %}
                        {{ task.due_date|date:"d.m.Y" }}
                        {% if task.is_overdue %}
                        <br><small class="text-danger">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ!</small>
                        {% endif %}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    <a href="#" class="btn btn-sm btn-info">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                    <a href="#" class="btn btn-sm btn-warning">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="alert alert-warning">
        üì≠ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.
    </div>
    {% endif %}
</div>
{% endblock %}
